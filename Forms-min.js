/* Labels + Forms */
if(typeof(Labels)==='undefined'){var Labels={}}(function(){var newLabels={PasswordInvalidChar:'Caracter Inválido digitado: {chars}',PasswordShort:'Senha muito curta',PasswordVeryWeak:'Senha muito fraca',PasswordWeak:'Senha fraca',PasswordRelevant:'Senha relevante',PasswordStrong:'Senha forte',PasswordVeryStrong:'Senha muito forte',FormErrorTitleAlert:'Preencha corretamente os seguintes campos:',FieldError:'Preencha corretamente o campo "{label}".',FieldValueEmpty:'O campo "{label}" deve ser preenchido.',FieldInvalidValue:'O conteúdo do campo "{label}" não é válido.',FieldSelectOne:'Você deve selecionar uma opção do campo "{label}".'};for(var it in newLabels){Labels[it]=newLabels[it]}})();
if(typeof(Interface)==='undefined'){var Interface={}}var Forms=new(function(){var static={FieldElement:function(o){var fl=o;if(typeof(o)==='string'){fl=Get(o)}var isdate=false;var o={self:fl,accept:GetProp(fl,'accept',null),autocomplete:GetBooleanProp(fl,'autocomplete',false),autofocus:GetBooleanProp(fl,'autofocus',false),checked:GetBooleanProp(fl,'checked',false),class:GetClass(fl),decimal:GetProp(fl,'data-decimal',0),def:GetProp(fl,'data-def',null),disabled:GetBooleanProp(fl,'disabled',false),format:GetBooleanProp(fl,'data-format',true),get:GetBooleanProp(fl,'data-get',true),id:GetProp(fl,'id',null),max:GetProp(fl,'max',null),maxLength:GetProp(fl,'maxlength',null),min:GetProp(fl,'min',null),multiple:GetBooleanProp(fl,'multiple',false),name:GetProp(fl,'name',null),pattern:GetProp(fl,'pattern',null),placeholder:GetProp(fl,'placeholder',null),radiovalue:null,readonly:GetBooleanProp(fl,'readonly',false),required:GetBooleanProp(fl,'required',false),systemvalue:GetProp(fl,'value',''),step:GetProp(fl,'step',null),tagName:fl.tagName.toLowerCase(),type:GetProp(fl,'type',null),title:GetProp(fl,'title',null),valid:GetBooleanProp(fl,'data-valid',true),validate:GetBooleanProp(fl,'data-validate',true),value:GetProp(fl,'value','')};if(o.value!=fl.value){o.value=fl.value;o.systemvalue=fl.value}if(o.type=='checkbox'){o.checked=fl.checked}for(var it in o.class){var cl=o.class[it].toLowerCase();switch(cl){case'type-datetime-local':case'type-datetime':case'type-date':case'type-month':case'type-week':case'type-time':case'type-number':case'type-range':case'type-email':case'type-color':case'type-tel':case'type-url':o.type=cl.replace('type-','');break}}if(o.def!=null){var sp=o.def.split('.');o.def=String.Pattern;for(var it in sp){var c=(sp[it]==':')?'World':sp[it];o.def=o.def[c]}}else if(o.type!=null){var wrp=String.Pattern.World;switch(o.type.toLowerCase()){case'datetime-local':o.def=wrp.Dates.DateTimeLocal;break;case'datetime':o.def=wrp.Dates.DateTime;break;case'date':o.def=wrp.Dates.Date;break;case'month':o.def=wrp.Dates.Month;break;case'week':o.def=wrp.Dates.Week;break;case'time':o.def=wrp.Dates.Time;break;case'number':case'range':o.def=wrp.Number;break;case'email':o.def=wrp.Email;break;case'color':o.def=wrp.Color;break;case'url':o.def=wrp.URL;break}}switch(o.type){case'button':case'submit':case'radio':case'checkbox':o.validate=false;break}if(o.tagName=='select'&&o.multiple){var nV=[];var s=Get('option[selected]',fl);for(var it in s){nV.push(s[it].value.toString())}o.value=nV}if(o.type=='radio'){var r=Get('input[name="'+o.name+'"]');for(var it in r){if(o.radiovalue===null&&r[it].checked){o.radiovalue=r[it].value.toString()}}}switch(o.type){case'datetime-local':case'datetime':case'date':case'month':case'week':var dMask=String.Pattern.World.Dates.DateTime.Mask;var d=null;var vd=o.value;if(o.def.Check(o.value)){if(o.type=='week'){if(typeof(WeekDate)!=='undefined'){var d=WeekDate.DateOfWeek(vd)}}else{var d=String.Pattern.FormatDateTime(vd,o.def.Mask)}if(d!=null){o.systemvalue=d.ToString(dMask)}}break;case'number':case'range':var nMask=String.Pattern.World.Number.Mask;if(o.def.Check(o.value)){dec='.';tho=',';if(o.def!=String.Pattern.World.Number){dec=o.def.Decimal;tho=o.def.Thousand}o.systemvalue=o.value.ReplaceAll(tho,'').replace(dec,'.')}break}if(o.title==null){var lbl=Get('label[for="'+o.id+'"]');if(lbl!==null){o.title=lbl[0].textContent}}return o},IsValidMinOrMax:function(o){var val=o.value;var min=o.min;var max=o.max;var minOK=(min==null)?true:false;var maxOK=(max==null)?true:false;switch(o.type){case'datetime-local':case'datetime':case'date':case'month':case'week':case'time':var f=(o.def!=null)?o.def.Mask:null;var iW=(o.type=='week')?true:false;if(iW&&typeof(WeekDate)==='undefined'){console.log('Namespace "WeekDate" não encontrada')}else{var aDate=(iW)?val.DateOfWeek():val.ToDate(f);var tDate=null;if(min!=null){tDate=(iW)?min.DateOfWeek():min.ToDate(f);minOK=(aDate>=tDate)?true:false}if(max!=null){tDate=(iW)?max.DateOfWeek():max.ToDate(f);maxOK=(aDate<=tDate)?true:false}}break;case'number':case'range':if(val.IsNumber()){var n=parseFloat(val);minOK=(min==null||n>=min)?true:false;maxOK=(max==null||n<=max)?true:false}break}return(minOK&&maxOK)?true:false},FieldValidate:function(o){if(typeof(o)==='string'||TypeOf(o).indexOf('[object HTML')!=-1){o=Forms.FieldElement(o)}else{var t=TypeOf(o);if(t=='[object KeyboardEvent]'||t=='[object FocusEvent]'){o=Forms.FieldElement(o.target)}}var iR=true;if(o.type!='range'){var v=o.value;if(o.validate){if(v==''){iR=(o.required)?null:true}else{if(o.def!=null){iR=(o.def.Check(v))?Forms.IsValidMinOrMax(o):false}else if(o.pattern!=null){iR=v.IsPatternMatch(o.pattern)}}}o.valid=iR;o.self.setAttribute('data-valid',iR);if(o.def!=null&&o.format&&iR&&o.type!='number'&&o.type!='url'){o.self.value=o.def.Format(v)}}return iR},RetrieveFormPack:function(o){var fields=null;var isV=true;var Data=new HashTable();var Erro=new HashTable();if(typeof(o)==='string'){fields=Get(o+' input, '+o+' textarea, '+o+' select')}else if(o.constructor===Array){fields=o}else{fields=Get('input, textarea, select',o)}var oInfo=[];for(var it in fields){if(GetBooleanProp(fields[it],'data-get',true)){var info=Forms.FieldElement(fields[it]);if(info.type=='radio'){if(info.checked){Data.Add(info.name,info.radiovalue)}}else if(info.type=='checkbox'){Data.Add(info.id,info.checked)}else{oInfo.push(info)}}}for(var it in oInfo){var info=oInfo[it];var valid=(info.validate)?Forms.FieldValidate(info):true;if(valid){if(info.def!=null&&info.format&&info.type!='range'){if(info.type=='number'){info.self.value=info.def.Format(info.self.value,undefined,info.decimal)}else{info.self.value=info.def.Format(info.self.value)}info.value=info.self.value}Data.Add(info.id,info.systemvalue)}else{var msg=Labels.FieldError;if(info.required&&info.value==''){switch(info.tagName){case'input':case'textarea':msg=Labels.FieldValueEmpty;break;case'select':msg=Labels.FieldSelectOne;break}}else{if(info.tagName=='input'){msg=Labels.FieldInvalidValue}}msg=msg.replace('{label}',info.title);Erro.Add(info.id,msg);isV=false}}return{Valid:isV,HashData:Data,HashError:Erro}}};newInterfaceMethods={SetActionOnEnter:function(o,ev){var fields=null;if(typeof(o)==='string'){fields=Get(o+' input')}else if(o.constructor===Array){fields=o}else{fields=Get('input',o)}if(fields!=null&&fields.length>0){var evt_Private_OnEnter=function(e){if(e.keyCode==13){ev()}};for(var it in fields){var fld=fields[it];var type=GetProp(fld,'type',null);var noget=GetProp(fld,'data-noget',null);if(noget==null){switch(type){case'datetime-local':case'datetime':case'date':case'month':case'week':case'time':case'number':case'range':case'email':case'color':case'tel':case'url':case'text':case'password':fld.addEventListener('keyup',evt_Private_OnEnter,false);break}}}}},SetRangeOutput:function(o){var ranges=null;var css='input[type="range"][data-simple-output="true"]';if(o===undefined){ranges=Get(css)}else if(typeof(o)=='string'){ranges=Get(o+' '+css)}else if(o.constructor===Array){ranges=o}else{ranges=(GetProp(o,'type',null)==null)?Get(css,o):ranges=[o]}if(ranges!=null&&ranges.length>0){var evt_Private_RangeOutput=function(o){o=(o===undefined)?this:(TypeOf(o)=='[object Event]')?o.target:o;var outName=o.getAttribute('id')+'_output';var form=null;var tempNode=o;while(form==null||tempNode.tagName.toLowerCase()=='html'){if(tempNode.tagName.toLowerCase()=='form'){form=tempNode}else{tempNode=tempNode.parentNode}}if(form!=null){form[outName].value=o.value}};for(var it in ranges){ranges[it].addEventListener('input',evt_Private_RangeOutput,false);evt_Private_RangeOutput(ranges[it])}}},SetFieldTips:function(o){var tips=null;if(o===undefined){tips=Get('[data-tipfor]')}else if(typeof(o)=='string'){tips=Get(o+' [data-tipfor]')}else if(o.constructor===Array){tips=o}else{var type=GetProp(o,'type',null);switch(type){case null:tips=Get('[data-tipfor]',o);break;case'input':case'textarea':case'select':var id=GetProp(o,'id',null);if(id!=null){tips=Get('[data-tipfor="'+id+'"]')}break}}if(tips!=null&&tips.length>0){var evt_Private_ShowTip=function(){var target=Get('[data-tipfor="'+this.getAttribute('id')+'"]');target[0].style.display='block'};var evt_Private_HideTip=function(){var target=Get('[data-tipfor="'+this.getAttribute('id')+'"]');target[0].style.display='none'};for(var it in tips){var tip=tips[it];var elID=GetProp(tip,'data-tipfor',null);if(elID!=null){var el=Get('#'+elID);if(el!=null){el.addEventListener('focus',evt_Private_ShowTip,false);el.addEventListener('blur',evt_Private_HideTip,false)}}}}},SetInputCounters:function(o,r){r=(r===undefined)?true:r;var fields=null;if(typeof(o)==='string'){fields=Get(o+' input, '+o+' textarea')}else if(o.constructor===Array){fields=o}else{fields=Get('input, textarea',o)}for(var it in fields){var fld=fields[it];var id=GetProp(fld,'id',null);var ml=GetProp(fld,'maxlength',null);var el=fld.tagName.toLowerCase();if(id!=null&&ml!=null&&(el=='input'||el=='textarea')){var ctNode=Get('[data-counterfor="'+fld.getAttribute('id')+'"]');if(ctNode!=null&&ctNode.length==1){fld.setAttribute('data-type-counter',r);var evt_Private_CountLength=function(f){f=(f===undefined)?this:(TypeOf(f)=='[object KeyboardEvent]')?f.target:f;var tC=GetBooleanProp(f,'data-type-counter',true);var tNode=Get('[data-counterfor="'+f.getAttribute('id')+'"]');var maxLen=GetProp(f,'maxlength',null);var valLen=f.value.length;var iLeft=valLen;if(tC){iLeft=maxLen-valLen}tNode[0].textContent=iLeft};fld.addEventListener('keyup',evt_Private_CountLength,false);evt_Private_CountLength(fld)}}}},SetFastSelect:function(o,m){var ifsel=null;var css='input[data-fastselect]';m=(m===undefined)?20:m;if(o===undefined){ifsel=Get(css)}else if(typeof(o)=='string'){ifsel=Get(o+' '+css)}else if(o.constructor===Array){ifsel=o}else{ifsel=(GetProp(o,'type',null)==null)?Get(css,o):ifsel=[o]}if(ifsel!=null&&ifsel.length>0){var evt_Private_BlurFastSelect=function(){var f=(f===undefined)?this:(TypeOf(f)=='[object KeyboardEvent]')?f.target:f;var fsFor=GetProp(f,'data-fastselect','');var sel=Get('#'+fsFor);var val=f.value;var opts=Get('option',sel);for(var i=0;i<opts.length;i++){if(val==opts[i].textContent){sel.selectedIndex=i}}};for(var it in ifsel){var inp=ifsel[it];var fsFor=GetProp(inp,'data-fastselect','');var sel=Get('#'+fsFor);var opts=Get('option',sel);if(opts!=null&&opts.length>=m){inp.setAttribute('list',fsFor+'_datalist');var ndlist=document.createElement('datalist');ndlist.setAttribute('id',fsFor+'_datalist');for(var i in opts){if(opts[i].value!=''){var nopt=document.createElement('option');nopt.setAttribute('value',opts[i].textContent);ndlist.appendChild(nopt)}}inp.parentNode.appendChild(ndlist);inp.addEventListener('input',evt_Private_BlurFastSelect,false)}}}},SetMultipleInput:function(o){var inp=null;var css='input[data-multiple-value]';if(o===undefined){inp=Get(css)}else if(typeof(o)=='string'){inp=Get(o+' '+css)}else if(o.constructor===Array){inp=o}else{inp=(GetProp(o,'type',null)==null)?Get(css,o):[o]}if(inp!=null&&inp.length>0){var evt_Private_InitiValues=function(id){var iReal=Get(id);var iRealValue=iReal.value.split(',');var nValue='';for(var it in iRealValue){if(IsNotNullValue(iRealValue[it])&&iRealValue[it].Trim()!=''){nValue+=iRealValue[it]+','}}iReal.value=nValue;iRealValue=nValue.split(',');for(var it in iRealValue){evt_Private_AddValueMarkup(id,iRealValue[it])}};var evt_Private_OnBlur=function(o){if(o.target.value!=''){evt_Private_AddNewValue(o);setTimeout(function(){o.target.focus()},10)}};var evt_Private_AddNewValue=function(o){key=o.keyCode;o=o.target;if(o.value!=''&&(key==9||key==13||key==188)){var id='#'+o.id.replace('_typefield','');var iReal=Get(id);var iRealValue=iReal.value.split(',');var iNewValue=o.value.ReplaceAll(',','').Trim();var nValue='';var isNotMatch=true;for(var it in iRealValue){if(IsNotNullValue(iRealValue[it])&&iRealValue[it].Trim()!=''){nValue+=iRealValue[it]+','}if(iRealValue[it]==iNewValue){isNotMatch=false}}if(isNotMatch){nValue+=iNewValue+',';evt_Private_AddValueMarkup(id,iNewValue)}iReal.value=nValue;o.value=''}};var evt_Private_AddValueMarkup=function(id,nValue){if(IsNotNullValue(nValue)&&nValue.Trim()!=''){var iShow=Get(id+'_show');var nLI=document.createElement('li');var remBtn=document.createElement('span');nLI.innerHTML=nValue;remBtn.addEventListener('click',evt_Private_RemoveValue,false);nLI.appendChild(remBtn);iShow.appendChild(nLI)}};var evt_Private_RemoveValue=function(o){o=o.target;var ulNode=o;var liNode=null;var remValue=null;var id=null;while(id==null){var tN=ulNode.tagName.toLowerCase();if(tN=='li'){liNode=ulNode;remValue=liNode.textContent}if(tN=='ul'){id=ulNode.id.replace('_show','')}else{ulNode=ulNode.parentNode}}var iReal=Get('#'+id);var iRealValue=iReal.value.split(',');var nValue='';for(var it in iRealValue){if(IsNotNullValue(iRealValue[it])&&iRealValue[it].Trim()!=''&&iRealValue[it]!=remValue){nValue+=iRealValue[it]+','}}ulNode.removeChild(liNode);iReal.value=nValue};for(var it in inp){var id='#'+inp[it].id;var iShow=Get(id+'_show');var iTypeField=Get(id+'_typefield');if(iShow!=null&&iTypeField!=null){iTypeField.addEventListener('keyup',evt_Private_AddNewValue,false);iTypeField.addEventListener('blur',evt_Private_OnBlur,false);evt_Private_InitiValues(id)}}}},SetMultipleSelectCommands:function(o){var fields=null;var mSelects=[];if(typeof(o)==='string'){fields=Get(o+' select')}else if(o.constructor===Array){fields=o}else{fields=Get('select',o)}for(var it in fields){var fld=fields[it];var m=GetBooleanProp(fld,'multiple',false);var g=GetBooleanProp(fld,'data-get',true);if(m&&g){if(Get('#'+fld.getAttribute('id')+'_dataorigin')!=null){mSelects.push(fld)}}}if(mSelects.length>0){var CMD_MoveOptionsBetweenSelects=function(){var btn=this.getAttribute('id');var oSel='';var tSel='#';var add=null;if(btn.indexOf('_add')!=-1){tSel+=btn.replace('_add','');add=true}else{tSel+=btn.replace('_remove','');add=false}oSel=tSel+'_dataorigin';var oSel=Get(oSel);var tSel=Get(tSel);var opts=[];var moveOpts=[];if(add){var opts=Get('option',oSel)}else{var opts=Get('option',tSel)}for(var it in opts){if(opts[it].selected==true){moveOpts.push(opts[it])}}for(var it in moveOpts){var o=moveOpts[it];var nOpt=document.createElement('option');nOpt.setAttribute('value',o.getAttribute('value'));nOpt.textContent=o.textContent.ReplaceAll('&','*§*').ReplaceAll('*§*','&amp;');if(add){tSel.appendChild(nOpt);oSel.removeChild(o)}else{oSel.appendChild(nOpt);tSel.removeChild(o)}}};for(var it in mSelects){var mS=mSelects[it];var bID='#'+mSelects[it].getAttribute('id');Get(bID+'_add').addEventListener('click',CMD_MoveOptionsBetweenSelects,false);Get(bID+'_remove').addEventListener('click',CMD_MoveOptionsBetweenSelects,false)}}},PasswordCheckConfig:{NullPassword:{Message:'',Class:'jsp-inactive-or-null-password'},InvalidChar:{Message:Labels.PasswordInvalidChar,Class:'jsp-invalid-password'},Short:{Message:Labels.PasswordShort,Class:'jsp-short-password'},VeryWeak:{Message:Labels.PasswordVeryWeak,Class:'jsp-very-weak-password'},Week:{Message:Labels.PasswordWeak,Class:'jsp-weak-password'},Relevant:{Message:Labels.PasswordRelevant,Class:'jsp-relevant-password'},Strong:{Message:Labels.PasswordStrong,Class:'jsp-strong-password'},VeryStrong:{Message:Labels.PasswordVeryStrong,Class:'jsp-very-strong-password'},MinLength:String.Pattern.World.Password.MinLength,SetClassOnInput:false},SetCheckPasswordStrength:function(o,cfg){var fields=null;cfg=(cfg===undefined)?{}:cfg;var config=CloneObject(Interface.PasswordCheckConfig);for(var it in cfg){config[it]=cfg[it]}if(typeof(o)==='string'){fields=Get(o+' input')}else if(o.constructor===Array){fields=o}else{fields=Get('input',o)}if(fields!=null&&fields.length>0){var pass=[];for(var it in fields){var type=GetProp(fields[it],'type',null);if(type=='password'){pass.push(fields[it])}}var classToRemove=[];for(var it in config){if(config[it].Class!==undefined){classToRemove.push(config[it].Class)}}var evt_Private_CheckPasswordStrength=function(){var val=this.value.toString();var pField=this;var nAlert=Get('[data-strength-of="'+this.getAttribute('id')+'"]')[0];var setMessageOnField=function(pst){SetClass(pField,pst.Class,classToRemove);SetClass(nAlert,pst.Class,classToRemove);nAlert.textContent=pst.Message};var isValidPassword=function(){var chars=val.IsPassword(true);if(chars!=''){setMessageOnField({Message:config.InvalidChar.Message.replace('{chars}',chars),Class:config.InvalidChar.Class})}return((chars=='')?true:false)};if(val.length==0){setMessageOnField({Message:nAlert.getAttribute('data-pass-text'),Class:config.NullPassword.Class})}else{if(val.length<config.MinLength){setMessageOnField(config.Short);isValidPassword()}else{if(isValidPassword()==true){var state=null;var strgt=val.PasswordStrength();if(strgt<=60){state=config.VeryWeak}else if(strgt<=80){state=config.Week}else if(strgt<=100){state=config.Relevant}else if(strgt<=160){state=config.Strong}else if(strgt>160){state=config.VeryStrong}setMessageOnField(state)}}}};for(var it in pass){var p=pass[it];var nodeAlert=Get('[data-strength-of="'+p.getAttribute('id')+'"]');if(nodeAlert!=null&&nodeAlert.length==1){var n=nodeAlert[0];n.setAttribute('data-pass-text',n.textContent);p.addEventListener('keyup',evt_Private_CheckPasswordStrength,false)}}}},SetCheckRetypePassword:function(o){var fields=null;if(typeof(o)==='string'){fields=Get(o+' input[type="password"]')}else if(o.constructor===Array){fields=o}else{fields=Get('input[type="password"]',o)}if(fields!=null&&fields.length>0){var evt_Private_OnRetype=function(){var id=this.id.replace('_retype','');var inp=Get('#'+id);var check=Get('#'+id+'_retype');var val=inp.value;var retype=check.value;var valid=(val=='')?'null':((val==retype)?'true':'false');check.setAttribute('data-valid',valid)};for(var it in fields){var id=GetProp(fields[it],'id','');var inp=Get('#'+id);var check=Get('#'+id+'_retype');if(check!=null){check.addEventListener('keyup',evt_Private_OnRetype,false);inp.addEventListener('keyup',evt_Private_OnRetype,false)}}}},SetFormFeatures:function(o){var form=null;var fields=null;if(typeof(o)==='string'){form=Get(o);fields=Get('input, select, textarea',form)}else if(o.constructor===Array){fields=o;if(fields.length>0){var tnode=fields[0];while(form==null){var pTag=tnode.tagName.toLowerCase();if(pTag=='form'){form=tnode.parentNode}tnode=tnode.parentNode}}}else{fields=Get('input, select, textarea',o)}if(fields!=null&&fields.length>0){var ReturnFalseFunction=function(){return false};form.setAttribute('novalidate','novalidate');form.addEventListener('submit',ReturnFalseFunction,false);Interface.SetFieldTips(form);Interface.SetRangeOutput(form);Interface.SetInputCounters(form);Interface.SetFastSelect(form);Interface.SetMultipleInput(form);Interface.SetMultipleSelectCommands(form);Interface.SetCheckPasswordStrength(form);Interface.SetCheckRetypePassword(form);var evt_Private_FieldFormatOnBlur=function(o){o=Forms.FieldElement(o.target);if(o.format){o.self.value=o.def.Format(o.value,undefined,o.decimal)}};for(var it in fields){var fld=Forms.FieldElement(fields[it]);if(fld.tagName=='textarea'||(fld.tagName=='input'&&fld.type!='password'&&fld.type!='radio'&&fld.type!='checkbox')){if(fld.def!=null&&fld.def.MaxLength!=null){fld.self.setAttribute('maxlength',fld.def.MaxLength)}if(fld.validate&&fld.type!='range'){fld.self.addEventListener('keyup',Forms.FieldValidate,false);if(fld.type=='url'||fld.type=='number'){fld.self.addEventListener('blur',evt_Private_FieldFormatOnBlur,false)}}}}}}};for(var it in newInterfaceMethods){Interface[it]=newInterfaceMethods[it]}return static});